<!DOCTYPE html>
<html lang="vi">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <link rel="preconnect" href="https://fonts.googleapis.com/">
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="">

    <!-- Bootstrap CSS v5.2.1 -->
    <link href="/assets/bootstrap.min.css" rel="stylesheet">
    <link rel="shortcut icon" href="/assets/images/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="/assets/app.css">

    <title>B·∫£ng x·∫øp h·∫°ng - S∆∞u Truy·ªán</title>
    
    <style>
        .ranking-tabs {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .ranking-tabs .nav-link {
            color: #666;
            font-weight: 600;
            padding: 12px 25px;
            border-radius: 10px;
            margin: 0 5px;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .ranking-tabs .nav-link:hover {
            background: #f8f9fa;
            color: #667eea;
        }

        .ranking-tabs .nav-link.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
        }

        .story-rank-item {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .story-rank-item:hover {
            box-shadow: 0 8px 16px rgba(102, 126, 234, 0.2);
            border-color: #667eea;
            transform: translateY(-2px);
        }

        .rank-number {
            font-size: 2rem;
            font-weight: 700;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 12px;
            flex-shrink: 0;
        }

        .rank-number.top-1 {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(245, 87, 108, 0.4);
        }

        .rank-number.top-2 {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(79, 172, 254, 0.4);
        }

        .rank-number.top-3 {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(67, 233, 123, 0.4);
        }

        .rank-number.other {
            background: #f8f9fa;
            color: #666;
            border: 2px solid #e9ecef;
        }

        .story-cover {
            width: 100px;
            height: 140px;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            flex-shrink: 0;
        }

        .story-cover img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .story-rank-item:hover .story-cover img {
            transform: scale(1.1);
        }

        .story-info {
            flex: 1;
            min-width: 0;
        }

        .story-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 10px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .story-title a {
            color: #2c3e50;
            text-decoration: none;
        }

        .story-title a:hover {
            color: #667eea;
        }

        .story-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 10px;
            color: #666;
            font-size: 0.9rem;
        }

        .story-meta-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .story-categories {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 10px;
        }

        .category-badge {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .category-badge:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(102, 126, 234, 0.3);
            color: white;
        }

        .story-description {
            color: #666;
            font-size: 0.95rem;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            line-height: 1.6;
        }

        .story-stats {
            display: flex;
            gap: 20px;
            padding-top: 15px;
            border-top: 1px solid #e9ecef;
            margin-top: 10px;
        }

        .stat-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .stat-value {
            font-size: 1.2rem;
            font-weight: 700;
            color: #667eea;
        }

        .stat-label {
            font-size: 0.8rem;
            color: #999;
            margin-top: 2px;
        }

        .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .status-badge.published {
            background: #d4edda;
            color: #155724;
        }

        .status-badge.pending {
            background: #fff3cd;
            color: #856404;
        }

        /* Pagination */
        .pagination-container {
            display: flex;
            justify-content: center;
            margin: 40px 0;
        }

        .pagination {
            display: flex;
            gap: 8px;
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .pagination .page-item {
            list-style: none;
        }

        .pagination .page-link {
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 45px;
            height: 45px;
            padding: 0 12px;
            border-radius: 10px;
            background: white;
            border: 2px solid #e9ecef;
            color: #666;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .pagination .page-link:hover {
            background: #667eea;
            color: white;
            border-color: #667eea;
            transform: translateY(-2px);
        }

        .pagination .page-item.active .page-link {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .pagination .page-item.disabled .page-link {
            opacity: 0.5;
            cursor: not-allowed;
            background: #f8f9fa;
        }

        .pagination .page-item.disabled .page-link:hover {
            background: #f8f9fa;
            color: #666;
            border-color: #e9ecef;
            transform: none;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .empty-state svg {
            width: 80px;
            height: 80px;
            fill: #ddd;
            margin-bottom: 20px;
        }

        .empty-state h3 {
            color: #666;
            margin-bottom: 10px;
        }

        .empty-state p {
            color: #999;
        }

        @media (max-width: 768px) {
            .ranking-title {
                font-size: 1.8rem;
            }

            .ranking-tabs .nav-link {
                padding: 10px 15px;
                font-size: 0.9rem;
            }

            .story-rank-item {
                padding: 15px;
            }

            .rank-number {
                width: 45px;
                height: 45px;
                font-size: 1.5rem;
            }

            .story-cover {
                width: 80px;
                height: 110px;
            }

            .story-title {
                font-size: 1.1rem;
            }

            .story-meta {
                gap: 10px;
                font-size: 0.85rem;
            }

            .pagination .page-link {
                min-width: 38px;
                height: 38px;
                font-size: 0.9rem;
            }
        }
    </style>
</head>

<body>
    <!-- Desktop Header -->
    {{> header}}

    <!-- Mobile Header -->
    <div class="header-mobile d-sm-block d-lg-none">
        <nav class="navbar navbar-dark bg-dark">
            <div class="container-fluid">
                <a class="navbar-brand" href="/">
                    <img src="/assets/images/logo_text.png" alt="Logo Suu Truyen" class="img-fluid" style="width: 200px;">
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasDarkNavbar">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="offcanvas offcanvas-end text-bg-dark w-75" tabindex="-1" id="offcanvasDarkNavbar">
                    <div class="offcanvas-header">
                        <img src="/assets/images/logo_text.png" alt="Logo Suu Truyen" class="img-fluid" style="width: 200px;">
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas"></button>
                    </div>
                    <div class="offcanvas-body">
                        <ul class="navbar-nav justify-content-end flex-grow-1 pe-3 mb-3">
                            <li class="nav-item">
                                <a class="nav-link" href="/">Trang ch·ªß</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link active" href="/ranking">B·∫£ng x·∫øp h·∫°ng</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </nav>
    </div>

    <main>
        <div class="container">
            <!-- Ranking Tabs -->
            <div class="ranking-tabs">
                <ul class="nav nav-pills justify-content-center" id="rankingTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <a class="nav-link {{#if (eq currentType 'day')}}active{{/if}}" 
                           href="/ranking?type=day" 
                           id="day-tab">
                            üìÖ Top Ng√†y
                        </a>
                    </li>
                    <li class="nav-item" role="presentation">
                        <a class="nav-link {{#if (eq currentType 'month')}}active{{/if}}" 
                           href="/ranking?type=month" 
                           id="month-tab">
                            üìÜ Top Th√°ng
                        </a>
                    </li>
                    <li class="nav-item" role="presentation">
                        <a class="nav-link {{#if (eq currentType 'alltime')}}active{{/if}}" 
                           href="/ranking?type=alltime" 
                           id="alltime-tab">
                            üèÜ All Time
                        </a>
                    </li>
                </ul>
            </div>

            <!-- Stories List -->
            <div class="stories-list">
                {{#if stories.length}}
                    {{#each stories}}
                    <div class="story-rank-item">
                        <div class="d-flex gap-3 flex-column flex-md-row">
                            <div class="rank-number {{#if (eq @index 0)}}top-1{{else if (eq @index 1)}}top-2{{else if (eq @index 2)}}top-3{{else}}other{{/if}}">
                                #{{inc @index}}
                            </div>
                            
                            <div class="story-cover">
                                <a href="/story/{{this.id}}">
                                    <img src="{{this.coverUrl}}" alt="{{this.title}}">
                                </a>
                            </div>
                            
                            <div class="story-info">
                                <h3 class="story-title">
                                    <a href="/story/{{this.id}}">
                                        {{this.title}}
                                    </a>
                                </h3>
                                
                                <div class="story-meta">
                                    <div class="story-meta-item">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                            <path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"/>
                                        </svg>
                                        <span>{{this.chapterCount}} Ch∆∞∆°ng</span>
                                    </div>
                                    {{#if this.expectedTotalChapters}}
                                    <div class="story-meta-item">
                                        <span class="status-badge {{this.statusClass}}">{{this.statusText}}</span>
                                    </div>
                                    {{/if}}
                                </div>
                                
                                <div class="story-categories">
                                    {{#each this.category}}
                                    <a href="/category/{{this}}" class="category-badge">{{this}}</a>
                                    {{/each}}
                                </div>
                                
                                <p class="story-description">{{this.description}}</p>
                            </div>
                        </div>
                    </div>
                    {{/each}}

                    <!-- Pagination -->
                    {{#if pagination}}
                    <div class="pagination-container">
                        <ul class="pagination">
                            <li class="page-item {{#if pagination.isFirstPage}}disabled{{/if}}">
                                <a class="page-link" href="?type={{currentType}}&page={{pagination.prevPage}}">‚Äπ</a>
                            </li>
                            
                            {{#if pagination.showFirst}}
                            <li class="page-item">
                                <a class="page-link" href="?type={{currentType}}&page=1">1</a>
                            </li>
                            {{#if pagination.showFirstDots}}
                            <li class="page-item disabled">
                                <span class="page-link">...</span>
                            </li>
                            {{/if}}
                            {{/if}}

                            {{#each pagination.pages}}
                            <li class="page-item {{#if this.active}}active{{/if}}">
                                <a class="page-link" href="?type={{../currentType}}&page={{this.number}}">{{this.number}}</a>
                            </li>
                            {{/each}}

                            {{#if pagination.showLast}}
                            {{#if pagination.showLastDots}}
                            <li class="page-item disabled">
                                <span class="page-link">...</span>
                            </li>
                            {{/if}}
                            <li class="page-item">
                                <a class="page-link" href="?type={{currentType}}&page={{pagination.totalPages}}">{{pagination.totalPages}}</a>
                            </li>
                            {{/if}}

                            <li class="page-item {{#if pagination.isLastPage}}disabled{{/if}}">
                                <a class="page-link" href="?type={{currentType}}&page={{pagination.nextPage}}">‚Ä∫</a>
                            </li>
                        </ul>
                    </div>
                    {{/if}}
                {{else}}
                <div class="empty-state">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"/>
                    </svg>
                    <h3>Ch∆∞a c√≥ d·ªØ li·ªáu</h3>
                    <p>Hi·ªán t·∫°i ch∆∞a c√≥ truy·ªán n√†o trong b·∫£ng x·∫øp h·∫°ng</p>
                </div>
                {{/if}}
            </div>
        </div>
    </main>

    <!-- Footer -->
    {{> footer}}

    <!-- Scripts -->
    <script src="/assets/jquery.min.js"></script>
    <script src="/assets/popper.min.js"></script>
    <script src="/assets/bootstrap.min.js"></script>
    <script src="/assets/app.js"></script>
    <script src="/assets/common.js"></script>
    <script src="/assets/auth.js"></script>

    <!-- Loading Spinner -->
    <div id="loadingPage" class="loading-full">
        <div class="loading-full_icon">
            <div class="spinner-grow"><span class="visually-hidden">Loading...</span></div>
        </div>
    </div>

</body>
</html>